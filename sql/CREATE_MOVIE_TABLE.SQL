CREATE TABLE MOVIE (
ID NUMBER,
CONSTRAINT MOVIE_ID PRIMARY KEY (ID),
TITLE NVARCHAR2(50) UNIQUE,
DIRECTOR NVARCHAR2(20) NOT NULL,
YEAR NUMBER(4),
CONSTRAINT YEAR_CHECK CHECK(YEAR > 1900 AND YEAR < 2020),
LENGTH_MINS NUMBER,
CONSTRAINT LENGTH_CHECK CHECK(LENGTH_MINS > 10 AND LENGTH_MINS < 200)
);

INSERT INTO MOVIE VALUES (1010, 'title1', 'zimekis', 1999, 120);
INSERT INTO MOVIE VALUES (1011, 'title2', 'zimekis', 2000, 120);
INSERT INTO MOVIE VALUES (1012, 'title3', 'mmm', 2000, 120);
INSERT INTO MOVIE VALUES (1013, 'title4', 'mmm', 1999, 120);
INSERT INTO MOVIE VALUES (1014, 'title5', 'mmm', 2002, 120);
INSERT INTO MOVIE VALUES (1015, 'title6', 'zimekis', 1999, 120);
INSERT INTO MOVIE VALUES (1016, 'title7', 'zimekis', 2000, 120);
INSERT INTO MOVIE VALUES (1017, 'title8', 'qqq', 2002, 120);

SELECT DIRECTOR, COUNT(TITLE) FROM MOVIE
GROUP BY DIRECTOR;

SELECT TITLE, YEAR FROM MOVIE
ORDER BY YEAR DESC;